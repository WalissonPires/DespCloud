Array.prototype.find||(Array.prototype.find=function(n){var t;if(this===null)throw new TypeError("Array.prototype.find called on null or undefined");if(typeof n!="function")throw new TypeError("predicate must be a function");var i=Object(this),u=i.length>>>0,f=arguments[1],r;for(t=0;t<u;t++)if(r=i[t],n.call(f,r,t,i))return r;return undefined}),function(){var n={};n.createNamespace=function(n){for(var r=n.split("."),t=window,i=0,u=r.length;i<u;i++)t[r[i]]===undefined&&(t[r[i]]={}),t=t[r[i]];return t};window.app=window.app||{};window.app.moduleUtils=n}(),function(){var t={striped:!0,rememberOrder:!0,pagination:!0,search:!0,showColumns:!0,showRefresh:!0,showToggle:!0,clickToSelect:!0,toolbar:undefined,url:undefined,columns:undefined,queryParams:function(n){return{limit:n.limit,page:n.offset,search:n.search,sort:n.sort,order:n.order}}},n={};n.dateFormat=function(n){var t=new Date(n);return isNaN(t)?n:`${(t.getDate()+"").padStart("0",2)}/${(t.getMonth()+1+"").padStart("0",2)}/${t.getFullYear()+""}`};n.addressFormat=function(n,t){if(t.address!==null&&t.address!==undefined){var i=t.address;return`${i.street}, ${i.number}, ${i.districtName} - ${i.cityName}/${i.countyInitials}`}return null};n.idFormat=function(n){return(n+"").padStart(6,"0")};n.currency=function(n){return"R$ "+n.toFixed(2)};n.mergeDefaultOptions=function(n){var i={};return Object.assign(i,t,n),i};n.getDataById=function(n,t){return n.bootstrapTable("getRowByUniqueId",t)};n.getSelected=function(n){return n.bootstrapTable("getAllSelections")};n.insertData=function(n,t,i){n.bootstrapTable("insertRow",{index:i||0,row:t})};n.updateData=function(n,t,i){n.bootstrapTable("updateByUniqueId",{id:i,row:t})};n.removeData=function(n,t){n.bootstrapTable("removeByUniqueId",t)};app.bootstrapTableUtils=n}(),function(){var t=function(n){return n!==null&&typeof n=="object"},i=function(n,r,u){var f,h;if(n!==null&&n!==undefined&&t(n)!==!1){r=typeof r=="string"?r:"raiz";for(f in n){var e=n[f],s=t(e),c={objeto:n,propriedade:f,valor:e,caminho:r,isObjeto:s},o=u(c);if(!o&&s&&(h=r.length===0?f:r+"."+f,o=i(e,h,u)),o)return!1}}},r=function(n,t){if(n===null||n===undefined)return null;var i=n;return $.each(t.split("."),function(n,t){i=i[t]}),i===n?null:i},n={};n.send=function(t,i){var r=$(t);i=i||{};$.ajax({url:r.attr("action"),method:r.attr("method")||"POST",data:r.serialize()}).done(function(n){typeof i.done=="function"&&i.done.call(r,n)}).fail(function(u){if(u.status===422)try{var f=JSON.parse(u.responseText);n.showModelStateMessages(t,f.details);alert(f.message||"Falha ao realizar operação")}catch(e){console.error("Exception",e);console.error("Response",u);alert("Falha ao interpretar resposta do servidor")}else typeof i.fail=="function"&&i.fail(r,u)}).always(function(){typeof i.always=="function"&&i.always.call(r)})};n.showModelStateMessages=function(n,t){var i=$(n).validate();i.showErrors(t)};n.loadData=function(n){function f(n,i){var u=n,r=t.map[n];return typeof r=="string"?u=r:Array.isArray(r)&&typeof r[0]=="string"&&(u=r[0]),t.root.length>0&&i!==!0?t.root+"."+u:u}var t,e,o,u;if(arguments.length!==1)throw"[form.carregarDados] Número de argumentos inválido";t={formSeletor:"",data:{},root:"",map:{},include:undefined,exclude:undefined};Object.assign(t,n);Array.isArray(t.include)&&(e=[],t.include.forEach(function(n){e.push(f(n))}),t.include=e);Array.isArray(t.exclude)&&(o=[],t.exclude.forEach(function(n){o.push(f(n))}),t.exclude=o);u={};$(t.formSelector).find("[name]").each(function(n,i){var r=i.getAttribute("name");Array.isArray(t.include)&&t.include.indexOf(r)===-1||Array.isArray(t.exclude)&&t.exclude.indexOf(r)>=0||(u[r]===undefined&&(u[r]=[]),u[r].push(i))});i(t.data,"",function(n){var i;if(!n.isObjeto&&!Array.isArray(n.valor)){i=n.valor;i instanceof Date&&(i=i.toLocaleDateString());typeof i=="function"&&(i=i.call(n.objeto));var e=n.caminho.length>0?n.caminho+"."+n.propriedade:n.propriedade,s=f(e,!0),o=u[s];o!==undefined&&o.forEach(function(n){var u,f,o;n.tagName==="SELECT"&&(u=t.map[e],Array.isArray(u)&&u.length===2&&(f=u[1],o=f!==undefined?r(t.data,f):i,$(n).find(`option[value="${i}"]`).length===0&&$(n).append(`<option value="${i}">${o}</option>`)));$(n).val(i)})}})};app.moduleUtils.createNamespace("app").formUtils=n}(),function(){var n={};n.maskAll=function(n){$(".number",n).mask("0#");$(".date",n).mask("00/00/0000",{placeholder:"__/__/____"});$(".time",n).mask("00:00:00",{placeholder:"__:__:__"});$(".date-time",n).mask("00/00/0000 00:00:00",{placeholder:"__/__/____ __:__:__"});$(".zipcode",n).mask("00000-000",{placeholder:"_____-___"});$(".phone",n).mask("90000-0000",{placeholder:"_____-____"});$(".phone-ddd",n).mask("(00) 90000-0000",{placeholder:"(__) _____-____"});$(".plate",n).mask("SSS-0000",{placeholder:"___-____"});$(".cpf",n).mask("000.000.000-00",{placeholder:"___.___.___-__",reverse:!0});$(".cnpj",n).mask("00.000.000/0000-00",{placeholder:"__.___.___/____-__",reverse:!0});$(".money",n).mask("000.000.000.000.000,00",{placeholder:"_,__",reverse:!0});$(".money2",n).mask("#.##0,00",{placeholder:"_,__",reverse:!0});$(".percent",n).mask("##0,00%",{placeholder:"_,__",reverse:!0});$(".yearManufactureModel",n).mask("00/00",{placeholder:"__/__"});$(".cpf-cnpj",n).each(function(n,t){var i={placeholder:"CPF ou CNPJ",onKeyPress:function(n,t,i,r){var u=["000.000.000-009","00.000.000/0000-00"],f=n.length>14?u[1]:u[0];$(i).mask(f,r)}};$(t).mask("000.000.000-009",i)})};app.moduleUtils.createNamespace("app").maskUtils=n}(),function(){var t={icon:"glyphicon glyphicon-info-sign"},i={element:"body",position:null,type:"info",allow_dismiss:!0,newest_on_top:!1,showProgressbar:!1,placement:{from:"top",align:"right"},offset:20,spacing:10,z_index:9999999,delay:5e3,timer:1e3,url_target:"_blank",mouse_over:null,animate:{enter:"animated fadeInDown",exit:"animated fadeOutUp"},onShow:null,onShown:null,onClose:null,onClosed:null,icon_type:"class",template:'<div data-notify="container" class="col-xs-11 col-sm-3 alert alert-{0}" role="alert"><button type="button" aria-hidden="true" class="close" data-notify="dismiss">×<\/button><span data-notify="icon"><\/span> <span data-notify="title">{1}<\/span> <span data-notify="message">{2}<\/span><div class="progress" data-notify="progressbar"><div class="progress-bar progress-bar-{0}" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%;"><\/div><\/div><a href="{3}" target="{4}" data-notify="url"><\/a><\/div>'},n={};n.show=function(n,r){var u=Object.assign({message:n,title:r},t);$.notify(u,i)};n.success=n.show;n.error=n.show;n.warn=n.show;app.moduleUtils.createNamespace("app").notify=n}(),function(){function i(){for(var i,n,r={},t=0;t<arguments.length;t++)for(i=Object.keys(arguments[t]),n=0;n<i.length;n++)r[i[n]]=arguments[t][i[n]];return r}function n(){}var t={title:"",subtitle:"",headerColor:"#88A0B9",background:null,theme:"",icon:null,iconText:null,iconColor:"",rtl:!1,width:800,top:null,bottom:null,borderBottom:!0,padding:0,radius:1,zindex:999999,iframe:!1,iframeHeight:400,iframeURL:null,focusInput:!0,group:"",loop:!1,arrowKeys:!0,navigateCaption:!0,navigateArrows:!0,history:!1,restoreDefaultContent:!1,autoOpen:0,bodyOverflow:!1,fullscreen:!0,openFullscreen:!1,closeOnEscape:!1,closeButton:!0,appendTo:"body",appendToOverlay:"body",overlay:!0,overlayClose:!1,overlayColor:"rgba(0, 0, 0, 0.4)",timeout:!1,timeoutProgressbar:!1,pauseOnHover:!1,timeoutProgressbarColor:"rgba(255,255,255,0.5)",transitionIn:"fadeIn",transitionOut:"fadeOut",transitionInOverlay:"fadeIn",transitionOutOverlay:"fadeOut",onFullscreen:function(){},onResize:function(){},onOpening:function(){},onOpened:function(){},onClosing:function(){var n=this;setTimeout(function(){$("#"+n.id).remove()},1e3)},onClosed:function(){},afterRender:function(){}};n.show=function(n){var r,u;$("#"+n.id).remove();r=$('<div id="'+n.id+'" class="izi-modal-app"><\/div>');r.append(n.contentHtml);r.appendTo($("body"));u=i(t,n);u.zindex+=10*$("body .iziModal").length;$("#"+n.id).iziModal(u);$("#"+n.id).iziModal("open")};n.hide=function(n){$("#"+n).iziModal("close")};app.modal=n}(),function(){function n(){this.parseResponse=function(n){var t=null;return n.then(function(n){t=n;var i=n.headers.get("content-type");if(i===null)return{};if(i&&i.indexOf("json")!==-1)return n.json();throw{status:0,title:"Unexpected response type: "+i+". Expected type: application/json"};}).then(function(n){var i={status:t.status,data:n},r={status:i.status,title:undefined,errors:undefined,data:undefined},f,u;try{if(Math.trunc(i.status/100)===2)return i.data;if(i.status===500)r.title="Error inesperado. Contacte o suporte técnico: "+i.data.title;else if(i.status===400)for(r.title="Um ou mais erros de validação ocorreram. Verifique os dados e tente novamente.",f=Object.keys(i.data.errors),r.errors={},u=0;u<f.length;u++)r.errors[f[u]]=i.data.errors[f[u]][0];else r.title="Falha ao interpretar resposta do servidor. Caso o problema persistir contacte o suporte técnico",r.data=i.data}catch(e){r.title="Ocorreu um erro inesperado ao ler a resposta do servidor.  Caso o problema persistir contacte o suporte técnico";r.data=e}throw r;}).catch(function(n){t!==null&&t.status===405?n={status:0,title:"Operação não pode ser executada pelo servidor"}:n.title===undefined&&(n={status:0,title:"Falha ao comunicar com o servidor"});throw n;})};this.build=function(n,t){var i,r,u;if(t=t||{},t.method=t.method||"GET",t.queryParams!==undefined&&t.queryParams!==null){i="";for(r in t.queryParams)if(value=t.queryParams[r],Array.isArray(value))for(u=0;u<value.length;u++)i+=i.length===0?r+"="+encodeURIComponent(value[u]):"&"+r+"="+encodeURIComponent(value[u]);else i+=i.length===0?r+"="+encodeURIComponent(value):"&"+r+"="+encodeURIComponent(value);i.length>0&&(n=n+"?"+i)}return t.headers=t.headers||{},t.headers.Accept=t.headers.Accept||"application/json",(t.method==="POST"||t.method==="PUT")&&t.headers["Content-Type"]===undefined&&(t.headers["Content-Type"]="application/json"),fetch(n,t)}}app.moduleUtils.createNamespace("app.utils").fetch=new n}(),function(){function n(){function f(n){var i=$(n.target).val();t=r.find(".app-active");t.removeClass("app-active");$("#"+i).addClass("app-active");window.location.hash=i}function e(n){var t=n.target.tagName==="A"?$(n.target):$(n.target).closest("a"),r=t.data("tab-load"),u=t.data("tab-title"),f=t.attr("href").replace("#",""),e=t.data("tab-manager");i.loadTab(r,f,u,e);s()&&h(!1)}function o(){n.change(f);$(window).resize(u);$(document).on("click","[data-tab-load]",e);c();u()}function s(){return $(document.body).is(".mobile-layout")}function u(){var n=$(document.body),t=window.matchMedia("screen and (max-width: 767px)").matches;t?n.addClass("mobile-layout"):n.removeClass("mobile-layout")}function h(n){var t=$(".navbar-header .bars");n===undefined?t.click():(isOpened=$("body.overlay-open").length>0,n&&!isOpened&&t.click(),!n&&isOpened&&t.click())}function c(){$(document).on("change",'input:not([type="password"])',function(n){n.target.value=n.target.value.toUpperCase()})}var i=this,r=$("#appLayoutTabsContent"),n=$("#appLayoutTabSelect"),t=null;this.loadTab=function(t,u,f,e){var o=$("#"+u);if(o.length!==0){i.activeTab(u);return}$.get(t).done(function(t){o.length===0&&(o=$('<div class="app-tab" id="'+u+'"><\/div>'),o.appendTo(r),n.append('<option value="'+u+'">'+f+"<\/option>"),n.selectpicker("refresh"));o.html(t);typeof e=="string"&&e.length>0&&new app[e]({rootElement:"#"+u});i.activeTab(u)}).fail(function(){app.notify.error("Falha ao baixar página. Verifique sua conexão com a internet.")})};this.activeTab=function(t){n.val(t);n.selectpicker("refresh").change()};this.closeTab=function(r){if($("#"+r).remove(),n.find('[value="'+r+'"]').remove(),t!==null){var u=t.attr("id");i.activeTab(u);t=null}};o()}$(document).ready(function(){app.layout=new n})}(),function(){var n=app.moduleUtils.createNamespace("app.entities");n.OrderStatus={OPENED:0,CLOSED:1,CANCELED:2,0:"Aberta",1:"Fechada",2:"Cancelada"}}(),function(){var n=app.moduleUtils.createNamespace("app.entities");n.VehicleType={MOTORCYCLE:0,CAR:1,0:"Moto",1:"Carro"}}(),function(){var n=`http://${window.location.hostname}:5011/api/`,t={getBaseUri:function(){return n}};app.moduleUtils.createNamespace("app.services").WebApi=t}(),function(){function t(){var t=this;this.getUserCompany=function(){var t=n+"/this",i=app.utils.fetch.build(t);return app.utils.fetch.parseResponse(i)};this.updateCompany=function(t){var i=app.utils.fetch.build(n,{method:"PUT",body:JSON.stringify(t)});return app.utils.fetch.parseResponse(i)};this.uploadLogo=function(t){var i=new FormData,r,u;return i.append("logo",t),r=n+"/this/logo",u=fetch(r,{method:"POST",body:i}),app.utils.fetch.parseResponse(u)}}var n=app.services.WebApi.getBaseUri()+"Companies",i=null;t.getSearchUrl=function(){return n};t.getBaseUri=function(){return n};t.getInstance=function(){return i===null&&(i=new t),i};app.moduleUtils.createNamespace("app.services").Companies=t}(),function(){function t(){var t=this;this.getById=function(t){var i=n+"/"+t,r=app.utils.fetch.build(i);return app.utils.fetch.parseResponse(r)};this.getAll=function(t){var i=app.utils.fetch.build(n,{queryParams:t});return app.utils.fetch.parseResponse(i)};this.createClient=function(t){var i=app.utils.fetch.build(n,{method:"POST",body:JSON.stringify(t)});return app.utils.fetch.parseResponse(i)};this.updateClient=function(t){var i=app.utils.fetch.build(n,{method:"PUT",body:JSON.stringify(t)});return app.utils.fetch.parseResponse(i)};this.deleteClient=function(t){var i=n+"/"+t,r=app.utils.fetch.build(i,{method:"DELETE"});return app.utils.fetch.parseResponse(r)}}var n=app.services.WebApi.getBaseUri()+"Clients",i=null;t.getSearchUrl=function(){return n};t.getInstance=function(){return i===null&&(i=new t),i};app.moduleUtils.createNamespace("app.services").Clients=t}(),function(){function t(){var t=this;this.getById=function(t){var i=n+"/"+t,r=app.utils.fetch.build(i);return app.utils.fetch.parseResponse(r)};this.getAll=function(){var t=app.utils.fetch.build(n);return app.utils.fetch.parseResponse(t)};this.createService=function(t){var i=app.utils.fetch.build(n,{method:"POST",body:JSON.stringify(t)});return app.utils.fetch.parseResponse(i)};this.updateService=function(t){var i=app.utils.fetch.build(n,{method:"PUT",body:JSON.stringify(t)});return app.utils.fetch.parseResponse(i)};this.deleteService=function(t){var i=n+"/"+t,r=app.utils.fetch.build(i,{method:"DELETE"});return app.utils.fetch.parseResponse(r)}}var n=app.services.WebApi.getBaseUri()+"Services",i=null;t.getSearchUrl=function(){return n};t.getInstance=function(){return i===null&&(i=new t),i};app.moduleUtils.createNamespace("app.services").Services=t}(),function(){function t(){var t=this;this.getById=function(t){var i=n+"/"+t,r=app.utils.fetch.build(i);return app.utils.fetch.parseResponse(r)};this.getAll=function(t){var i=app.utils.fetch.build(n,{queryParams:t});return app.utils.fetch.parseResponse(i)};this.createVehicle=function(t){var i=app.utils.fetch.build(n,{method:"POST",body:JSON.stringify(t)});return app.utils.fetch.parseResponse(i)};this.updateVehicle=function(t){var i=app.utils.fetch.build(n,{method:"PUT",body:JSON.stringify(t)});return app.utils.fetch.parseResponse(i)};this.deleteClient=function(t){var i=n+"/"+t,r=app.utils.fetch.build(i,{method:"DELETE"});return app.utils.fetch.parseResponse(r)}}var n=app.services.WebApi.getBaseUri()+"Vehicles",i=null;t.getSearchUrl=function(){return n};t.getInstance=function(){return i===null&&(i=new t),i};app.moduleUtils.createNamespace("app.services").Vehicles=t}(),function(){function t(){var t=this;this.getById=function(t){var i=n+"/"+t,r=app.utils.fetch.build(i);return app.utils.fetch.parseResponse(r)};this.getAll=function(t){var i=app.utils.fetch.build(n,{queryParams:t});return app.utils.fetch.parseResponse(i)};this.createOrder=function(t){var i=app.utils.fetch.build(n,{method:"POST",body:JSON.stringify(t)});return app.utils.fetch.parseResponse(i)};this.updateOrder=function(t){var i=app.utils.fetch.build(n,{method:"PUT",body:JSON.stringify(t)});return app.utils.fetch.parseResponse(i)};this.printReceipt=function(n){var t=r+"/receipt?orderid="+n;window.open(t,"_blank")}}var n=app.services.WebApi.getBaseUri()+"ServiceOrders",r=app.services.WebApi.getBaseUri()+"Reports",i=null;t.getSearchUrl=function(){return n};t.getInstance=function(){return i===null&&(i=new t),i};app.moduleUtils.createNamespace("app.services").ServiceOrders=t}(),function(){function t(){var t=this;this.getAll=function(t){var i=app.utils.fetch.build(n,{queryParams:t});return app.utils.fetch.parseResponse(i)};this.getById=function(t){var i=n+"/"+t,r=app.utils.fetch.build(i);return app.utils.fetch.parseResponse(r)};this.createItem=function(t){var i=app.utils.fetch.build(n,{method:"POST",body:JSON.stringify(t)});return app.utils.fetch.parseResponse(i)};this.updateItem=function(t){var i=app.utils.fetch.build(n,{method:"PUT",body:JSON.stringify(t)});return app.utils.fetch.parseResponse(i)};this.deleteItem=function(t){var i=n+"/"+t,r=app.utils.fetch.build(i,{method:"DELETE"});return app.utils.fetch.parseResponse(r)}}var n=app.services.WebApi.getBaseUri()+"OrderServiceItems",i=null;t.getSearchUrl=function(){return n};t.getInstance=function(){return i===null&&(i=new t),i};app.moduleUtils.createNamespace("app.services").OrderServiceItems=t}(),function(){function t(n){var t=$(n.selectSelector);return new Promise(function(i,r){n._getData(n._getDataParams).then(function(r){var u,e,f;for(data=r.map(n._dataMap),e=n.selected!==undefined?n.selected:"",data.unshift({id:"#new",text:n._newOptionText}),data.unshift({id:"",text:"Selecionar..."}),t.empty(),f=0;f<data.length;f++)u=data[f],t.append(new Option(u.text,u.id,e===u.id,e===u.id));t.hasClass("ui-selectpicker")&&(t.removeClass("ui-selectpicker").addClass("selectpicker"),t.selectpicker());t.change(function(){t.val()==="#new"&&(t.selectpicker("val",""),n._callEditor.call(null,t))});i(r)}).catch(function(n){app.notify.error("Falha ao carregar dados");r(n)})})}function n(n){var t=$(n.selectSelector),i=n._getData.call();return i=app.utils.fetch.parseResponse(i),i.then(function(i){var o=i.map(n._dataMap),s=t.val(),r,f,u,e;for(t.empty(),u=0;u<o.length;u++){if(r=o[u],f=new Option(r.text,r.id,r.id==s,r.id==s),r.data!==undefined)for(e in r.data)$(f).data(e,r.data[e]);t.append(f)}return t.hasClass("ui-selectpicker")?(t.removeClass("ui-selectpicker").addClass("selectpicker"),t.selectpicker()):t.is(".selectpicker")&&t.selectpicker("refresh"),i}).catch(function(){t.empty()}),i}function i(){this.clients=function(n){var t=$(n.selectSelector);return new Promise(function(i,r){app.services.Clients.getInstance().getAll().then(function(r){var u,e=n.selected!==undefined?n.selected:"",f;for(r.unshift({id:"#new",name:"CADASTRAR CLIENTE"}),r.unshift({id:"",name:"Selecionar..."}),f=0;f<r.length;f++)u=r[f],t.append(new Option(u.name,u.id,e===u.id,e===u.id));t.hasClass("ui-selectpicker")&&(t.removeClass("ui-selectpicker").addClass("selectpicker"),t.selectpicker());t.change(function(){t.val()==="#new"&&(t.selectpicker("val",""),clientEditor=new app.ClientEditor({modal:!0,onSave:function(i){return t.append(new Option(i.name,i.id,!0,!0)),t.selectpicker("refresh"),typeof n.onNewData=="function"&&n.onNewData.call(t,i),!0}}))});i(r)}).catch(function(n){app.notify.error("Falha ao carregar clientes");r(n)})})};this.services=function(n){return n._getData=app.services.Services.getInstance().getAll,n._newOptionText="CADASTRAR SERVIÇO",n._dataMap=function(n){return{id:n.id,text:n.name}},n._callEditor=function(t){serviceEditor=new app.ServiceEditor({modal:!0,onSave:function(i){return t.append(new Option(i.name,i.id,!0,!0)),t.selectpicker("refresh"),typeof n.onNewData=="function"&&n.onNewData.call(t,i),!0}})},t(n)};this.vehicles=function(n){return n._getData=app.services.Vehicles.getInstance().getAll,n._getDataParams={clientId:n.clientId},n._newOptionText="CADASTRAR VEÍCULO",n._dataMap=function(n){return{id:n.id,text:n.model}},n._callEditor=function(t){vehicleEditor=new app.VehicleEditor({modal:!0,data:{clientId:n.clientId},onSave:function(i){return t.append(new Option(i.model,i.id,!0,!0)),t.selectpicker("refresh"),typeof n.onNewData=="function"&&n.onNewData.call(t,i),!0}})},t(n)};this.countys=function(t){return t._getData=function(){var n=app.services.WebApi.getBaseUri()+"address/countys";return app.utils.fetch.build(n,{method:"GET"})},t._dataMap=function(n){return{id:n.id,text:n.name,data:{initials:n.initials}}},n(t)};this.citys=function(t){return t._getData=function(){var n=app.services.WebApi.getBaseUri()+"address/county/"+t.countyId+"/citys";return app.utils.fetch.build(n,{method:"GET"})},t._dataMap=function(n){return{id:n.id,text:n.name}},n(t)};this.districts=function(t){return t._getData=function(){var n=app.services.WebApi.getBaseUri()+"address/city/"+t.cityId+"/districts";return app.utils.fetch.build(n,{method:"GET"})},t._dataMap=function(n){return{id:n.id,text:n.name}},n(t)};this.addressUI=function(n){n=n||document;var i=$("select[data-county]",n),t=$("select[data-city]",n),r=$("select[data-district]",n),e=$("[data-zipcode]",n),c=$("[data-street]",n),o=$("input[data-countyName]",n),s=$("input[data-countyInitials]",n),u=$("input[data-cityName]",n),f=$("input[data-districtName]",n),l=$("[data-search-zipcode]",n);l.click(function(){var l=e.cleanVal();if(l===""){e.focus();app.notify.warn("Informe o CEP que deseja pesquisar");return}var n=e.closest(".address-content"),a=app.services.WebApi.getBaseUri()+"address/zipcode/"+l,h=app.utils.fetch.build(a,{method:"GET"});h=app.utils.fetch.parseResponse(h);n.length>0&&n.addClass("loading");h.then(function(e){var h;c.val(e.street);i.find('option[value="'+e.countyId+'"]').length===0&&(h=new Option(e.countyName,e.countyId,!0,!0),h.data("initials",e.countyInitials),i.append(h));i.val(e.countyId);i.selectpicker("refresh");o.val(e.countyName);s.val(e.countyInitials);t.empty();h=new Option(e.cityName,e.cityId,!0,!0);t.append(h);t.selectpicker("refresh");u.val(e.cityName);r.empty();h=new Option(e.districtName,e.districtId,!0,!0);r.append(h);r.selectpicker("refresh");f.val(e.districtName);n.length>0&&n.removeClass("loading")}).catch(function(t){t.title===undefined?app.notify.error("Ops, falha inesperada. Contacte o suporte técnico. "+(t.message||"")):app.notify.error(t.title);n.length>0&&n.removeClass("loading")})});i.change(function(n){var r=$(n.target).val(),i=$(n.target).find(":selected");o.val(i.text());s.val(i.data("initials"));app.ui.select.citys({countyId:r,selectSelector:t}).then(function(){u.val($(n.target).find(":selected").text());t.change()})});t.change(function(n){var t=$(n.target).val();u.val($(n.target).find(":selected").text());app.ui.select.districts({cityId:t,selectSelector:r}).then(function(){f.val($(n.target).find(":selected").text())})});r.change(function(n){f.val($(n.target).find(":selected").text())});var a=app.ui.select.countys({selectSelector:i}),v=app.ui.select.citys({countyId:i.val(),selectSelector:t}),y=app.ui.select.districts({cityId:t.val(),selectSelector:r}),h=Promise.all([a,v,y]);return h.then(function(){var n=i.find(":selected");o.val(n.text());s.val(n.data("initials"));u.val(t.find(":selected").text());f.val(r.find(":selected").text())}),h}}app.moduleUtils.createNamespace("app.ui").select=new i}(),function(){function n(n,t){function s(){app.modal.show({id:r,contentHtml:e,onOpened:function(){i.find('[name="exit"]').attr("data-izimodal-close","")}});i=$("#"+r);o()}function h(){i=$('<div id="'+r+'" class=""><\/div>');i.html(e);i.appendTo(t.rootElement);o()}function o(){var r;if(typeof n.pageUrl=="string")r=$.get(n.pageUrl);else if(typeof n.pageUrl=="function"&&(r=n.pageUrl.call(n.owner),r!==null||typeof r.done!="function"))throw new Error("Expected ajax promise");r.done(function(r){t.modal?i.iziModal("setContent",r):i.html(r);n.initElements&&n.initElements.call(n.owner)}).fail(function(){app.notify.error("Falha ao carregar página")})}function c(){t.modal===!0?s():h()}t=t||{};n=n||{};n.name=n.name||"base";n.owner=n.owner||this;var u=this,r=n.name+"-editor-"+(new Date).getTime(),i=null,e='<div class="app-card-load-content" style="background-color: #fff; padding: 20px;">Carregando...<\/id>',l=app.services.Clients.getInstance(),f=null;this.getContext=function(){return i};this.init=function(){c()};this.disabledBtnActions=function(){i.find(".row-group-btn .btn").attr("disabled","disabled")};this.enableBtnActions=function(){i.find(".row-group-btn .btn").attr("disabled",null)};this.submitForm=function(e,o){try{if($(e).valid()===!1)return;var c={formatterValue:function(n,t){var r=i.find('[name="'+t+'"].masked');return(r.length>0&&(n=r.cleanVal()),n==="")?undefined:n}},h=$(e).serializeJson(c),s=o.call(n.owner,h);if(s===undefined)throw new Error("Retorno do metodo não definido");if(s.sendData===undefined)throw new Error("Método de envio não configurado");u.disabledBtnActions();s.sendData.call(n.owner,h).then(function(i){app.formUtils.loadData({formSelector:e,data:i});typeof t.onSave=="function"&&t.onSave.call(n.owner,i,s.newData)===!0&&t.modal&&app.modal.hide(r)}).catch(function(n){if(n.title===undefined){app.notify.error("Ops. Falha inesperada");return}n.status===400&&f!==null?(f.showErrors(n.errors),app.notify.warn(n.title)):app.notify.error(n.title)}).then(function(){u.enableBtnActions()})}catch(l){u.enableBtnActions();app.notify.error("Ops, falha inesperada. Contacte o suporte técnico.");console.log(l)}};this.setFormValidator=function(n){f=n}}window.app.BaseEditor=n}(),function(){function n(n){function e(){s();o()}function o(){var n=app.bootstrapTableUtils.mergeDefaultOptions({toolbar:"#appTabServiceOrders .btn-group-manager",url:app.services.ServiceOrders.getSearchUrl(),uniqueId:"id",columns:[{radio:"state",title:""},{field:"id",title:"Protocolo",sortable:!0,formatter:app.bootstrapTableUtils.idFormat},{field:"client.name",title:"Cliente",sortable:!0},{field:"createAt",title:"Criada em",formatter:app.bootstrapTableUtils.dateFormat},{field:"status",title:"Status",sortable:!0,formatter:function(n){return app.entities.OrderStatus[n]}},{field:"total",title:"Valor total",formatter:app.bootstrapTableUtils.currency}]});t=$('[name="tableServiceOrders"]').bootstrapTable(n)}function s(){i.find('[name="newOS"]').click(c);i.find('[name="editOS"]').click(l);i.find('[name="printReceipt"]').click(a)}function u(n){h(n);var i={modal:!0,data:n,onSave:function(n,i){if(i){var r=app.bootstrapTableUtils.getDataById(t,n.id);r===null&&app.bootstrapTableUtils.insertData(t,n)}else app.bootstrapTableUtils.updateData(t,n,n.id);return app.notify.success("OS salva com sucesso"),!1}};f=new app.OrderServiceEditor(i)}function h(){}function c(){u({id:0,createAt:moment().format("YYYY-MM-DD"),total:0,status:app.entities.OrderStatus.OPENED,client:{id:""}})}function l(n){var i=app.bootstrapTableUtils.getSelected(t)[0];if(i===undefined){app.notify.warn("Selecione uma ordem de serviço");return}$(n.target).attr("disabled","disabled");r.getById(i.id).then(function(t){$(n.target).attr("disabled",null);u(t)}).catch(function(t){$(n.target).attr("disabled",null);t.title===undefined?app.notify.error("Ops, falha inesperada. Contacte o suporte técnico. "+(t.message||"")):app.notify.error(t.title)})}function a(){var n=app.bootstrapTableUtils.getSelected(t)[0];if(n===undefined){app.notify.warn("Selecione uma ordem de serviço");return}if(n.status!==app.entities.OrderStatus.CLOSED){app.notify.warn("Finalize a OS para realizar a impressão do recibo");return}r.printReceipt(n.id)}var i=$(n.rootElement),t=null,f=null,r=app.services.ServiceOrders.getInstance();e()}window.app.ServiceOrdersManager=n}(),function(){function n(n){function y(){var n=t.find("form").serializeJson();if(+n.id==0){app.notify.warn("Salve a ordem de serviço antes de adicionar os items");return}l({orderId:n.id})}function p(n){var t=app.bootstrapTableUtils.getSelected(i)[0];if(t===undefined){app.notify.error("Selecione um item");return}$(n.target).attr("disabled","disabled");o.getById(t.id).then(function(t){$(n.target).attr("disabled",null);l(t)}).catch(function(t){$(n.target).attr("disabled",null);t.title===undefined?app.notify.error("Ops, falha inesperada. Contacte o suporte técnico. "+(t.message||"")):app.notify.error(t.title)})}function w(){var n=app.bootstrapTableUtils.getSelected(i)[0];if(n===undefined){app.notify.error("Selecione um item");return}o.deleteItem(n.id).then(function(){app.bootstrapTableUtils.removeData(i,n.id);c();app.notify.success("Item deletado com sucesso")}).catch(function(n){n.title===undefined?app.notify.error("Ops, falha inesperada. Contacte o suporte técnico. "+(n.message||"")):app.notify.error(n.title)})}function b(t){var h,i,o,f;(t.preventDefault(),$(t.target).valid()!==!1)&&(h={formatterValue:function(n){return n}},i=$(this).serializeJson(h),rt(),o=null,f=+i.id==0,o=f?e.createOrder(i):e.updateOrder(i),o.then(function(t){typeof n.onSave=="function"&&(n.onSave.call(u,t,f)===!0&&n.modal&&app.modal.hide(r),f&&a());u.updateData(t)}).catch(function(n){if(n.title===undefined){app.notify.error("Ops, falha inesperada. Contacte o suporte técnico. "+(n.message||""));return}n.status===400?(s.showErrors(n.errors),app.notify.warn(n.title)):app.notify.error(n.title)}).then(function(){ut()}))}function k(){app.modal.show({id:r,contentHtml:f,onOpened:function(){t.find('[name="exit"]').attr("data-izimodal-close","")}});t=$("#"+r);h()}function d(){t=$('<div id="'+r+'" class=""><\/div>');t.html(f);t.appendTo(n.rootElement);h()}function h(){$.get("../ServiceOrders/_OrderServiceUI").done(function(i){n.modal?t.iziModal("setContent",i):t.html(i);nt()}).fail(function(){app.notify.error("Falha ao carregar página")})}function g(){n.modal===!0?k():d()}function nt(){var i=t.find("form"),r;n.data!==null&&typeof n.data=="object"&&(u.updateData(n.data),n.data.status!==0&&ft(i));tt(i);app.ui.select.clients({selectSelector:t.find('[name="clientId"]'),selected:n.data!==undefined&&n.data!==null?n.data.clientId:undefined});t.find(".selectpicker").selectpicker();r=n.data!==undefined&&n.data!==null?n.data.items:[];it(r);n.data!==undefined&&n.data.id>0?a():i.find('[name="status"]').attr("disabled",!0).selectpicker("refresh");et()}function tt(n){s=n.validate({rules:{createAt:{required:!0},clientId:{selectRequired:!0}}})}function it(n){var u=app.bootstrapTableUtils.mergeDefaultOptions({toolbar:"#"+r+" .btn-group-manager",url:undefined,uniqueId:"id",data:n,columns:[{radio:"state",title:""},{field:"id",title:"Código",sortable:!0,visable:!1},{field:"service.name",title:"Serviço",sortable:!0},{field:"vehicle.model",title:"Veículo"},{field:"total",title:"Valor Total",formatter:app.bootstrapTableUtils.currency}]});i=t.find('[name="tableServices"]').bootstrapTable(u)}function rt(){t.find(".row-group-btn .btn").attr("disabled","disabled")}function ut(){t.find(".row-group-btn .btn").attr("disabled",null)}function ft(n){n.find(".row-data").addClass("disabled");n.find('[name="save"]').attr("disabled",!0)}function et(){t.find('[name="addService"]').click(y);t.find('[name="editService"]').click(p);t.find('[name="removeService"]').click(w);t.find("form").submit(b)}function c(){for(var r=i.bootstrapTable("getData",!1),u=0,n=0;n<r.length;n++)u+=r[n].total;t.find('form [name="total"]').val(u)}function l(n){var r={modal:!0,data:n,clientId:parseInt(t.find('[name="clientId"]').val()),onSave:function(n,t){if(t){var r=app.bootstrapTableUtils.getDataById(i,n.id);r===null&&app.bootstrapTableUtils.insertData(i,n)}else app.bootstrapTableUtils.updateData(i,n,n.id);return c(),app.notify.success("Item salvo com sucesso"),!0}};v=new app.OrderServiceItemEditor(r)}function a(n){n===!1?(t.find(".noupdate:not(.bootstrap-select)").attr("disabled",null),t.find(".noupdate.bootstrap-select").removeClass("disabled").children(".btn ").removeClass("disabled")):(t.find(".noupdate:not(.bootstrap-select)").attr("disabled","disabled"),t.find(".noupdate.bootstrap-select").addClass("disabled").children(".btn ").addClass("disabled"))}function ot(n){typeof n.createAt=="string"&&(n.createAt=moment(n.createAt).format("YYYY-MM-DD"));typeof n.closedAt=="string"&&(n.closedAt=moment(n.closedAt).format("YYYY-MM-DD"))}n=n||{};var u=this,r="order-service-editor-"+(new Date).getTime(),t=null,f='<div class="app-card-load-content" style="background-color: #fff; padding: 20px;">Carregando...<\/id>',e=app.services.ServiceOrders.getInstance(),o=app.services.OrderServiceItems.getInstance(),s=null,v=null,i=null;g();this.updateData=function(n){ot(n);var i=t.find("form");app.formUtils.loadData({formSelector:i,data:n,map:{clientId:[null,"client.name"]}})}}window.app.OrderServiceEditor=n}(),function(){function n(n){function e(n){n.preventDefault();t.submitForm(n.target,function(n){var t={newData:+n.id==0};return t.sendData=t.newData?u.createClient:u.updateClient,t})}function o(){var t=i.find("form");n.data!==null&&typeof n.data=="object"&&l(t,n.data);c(t);app.maskUtils.maskAll(i);app.ui.select.addressUI(i);h()}function s(){r.owner=f;r.initElements=o;r.pageUrl="../Clients/_ClientUI";t=new app.BaseEditor(r,n);t.init();i=t.getContext()}function h(){i.find("form").submit(e)}function c(n){var i=n.validate({rules:{name:{required:!0,minlength:3,maxlength:100},email:{email:!0,minlength:3,maxlength:60},cpfCnpj:{minlength:14,maxlength:18},phone:{minlength:14,maxlength:15},contactName:{minlength:3,maxlength:60},rgIe:{minlength:3,maxlength:20},org:{minlength:2,maxlength:20},"address.number":{minlength:1,maxlength:30},"address.street":{minlength:2,maxlength:200},"address.districtId":{},"address.cityId":{},"address.countyId":{}}});t.setFormValidator(i)}function l(n,t){app.formUtils.loadData({formSelector:n,data:t,map:{"address.countyId":[null,"address.countyName"],"address.cityId":[null,"address.cityName"],"address.districtId":[null,"address.districtName"]}})}var r={},t=null,f=this,i=null,u=app.services.Clients.getInstance();s()}window.app.ClientEditor=n}(),function(){function n(n){function e(){s();o()}function o(){var n=app.bootstrapTableUtils.mergeDefaultOptions({toolbar:"#appTabClients .btn-group-manager",url:app.services.Clients.getSearchUrl(),uniqueId:"id",columns:[{radio:"state",title:""},{field:"id",title:"Código",sortable:!0,formatter:app.bootstrapTableUtils.idFormat},{field:"name",title:"Nome",sortable:!0},{field:"phone",title:"Telefone",formatter:null},{field:"contactName",title:"Contato",visible:!1,sortable:!0},{field:"email",title:"Email",sortable:!0},{field:"cpfCnpj",title:"CPF/CNPJ",visible:!1,formatter:null},{field:"rgIE",title:"RG/IE",visible:!1,sortable:!0,formatter:null},{field:"org",title:"Orgão Emissor",visible:!1},{field:"address",title:"Endereço",sortable:!0,formatter:app.bootstrapTableUtils.addressFormat}]});t=$('[name="tableClients"]').bootstrapTable(n)}function s(){i.find('[name="newClient"]').click(h);i.find('[name="editClient"]').click(c);i.find('[name="deleteClient"]').click(l)}function u(n){var i={modal:!0,data:n,onSave:function(n,i){if(i){var r=app.bootstrapTableUtils.getDataById(t,n.id);r===null&&app.bootstrapTableUtils.insertData(t,n)}else app.bootstrapTableUtils.updateData(t,n,n.id);return app.notify.success("Cliente salvo com sucesso"),!0}};f=new app.ClientEditor(i)}function h(){u({id:0})}function c(n){var i=app.bootstrapTableUtils.getSelected(t)[0];if(i===undefined){app.notify.warn("Selecione um cliente");return}$(n.target).attr("disabled","disabled");r.getById(i.id).then(function(t){$(n.target).attr("disabled",null);u(t)}).catch(function(t){$(n.target).attr("disabled",null);t.title===undefined?app.notify.error("Ops, falha inesperada. Contacte o suporte técnico. "+(t.message||"")):app.notify.error(t.title)})}function l(n){var i=app.bootstrapTableUtils.getSelected(t)[0];if(i===undefined){app.notify.warn("Selecione um cliente");return}$(n.target).attr("disabled","disabled");r.deleteClient(i.id).then(function(){$(n.target).attr("disabled",null);app.bootstrapTableUtils.removeData(t,i.id);app.notify.success("Cliente excluido")}).catch(function(t){$(n.target).attr("disabled",null);t.title===undefined?app.notify.error("Ops, falha inesperada. Contacte o suporte técnico. "+(t.message||"")):app.notify.error(t.title)})}var i=$(n.rootElement),t=null,f=null,r=app.services.Clients.getInstance();e()}window.app.ClientsManager=n}(),function(){function n(n){function o(n){n.preventDefault();i.submitForm(n.target,function(n){var t={newData:+n.id==0};return t.sendData=t.newData?f.createItem:f.updateItem,t})}function s(n){var r=parseInt($(n.target).val()),i;if(r>0){if(i=u.find(function(n){return n.id===r}),i===undefined){app.notify.error("Falha ao obter dados do serviço");return}app.formUtils.loadData({formSelector:t.find("form"),data:{"service.honorary":i.honorary,"service.rate":i.rate,"service.plateCard":i.plateCard,"service.other":i.other}})}}function h(){var i=t.find("form");n.data!==null&&typeof n.data=="object"&&app.formUtils.loadData({formSelector:i,data:n.data,map:{vehicleId:[null,"vehicle.model"],serviceId:[null,"service.name"]}});a(i);app.maskUtils.maskAll(t);app.ui.select.services({selectSelector:t.find('[name="serviceId"]'),selected:n.data!==undefined&&n.data!==null?n.data.serviceId:undefined,onNewData:function(n){u.push(n);$(this).change()}}).then(function(n){u=n});app.ui.select.vehicles({selectSelector:t.find('[name="vehicleId"]'),selected:n.data!==undefined&&n.data!==null?n.data.vehicleId:undefined,clientId:n.clientId});t.find(".selectpicker").selectpicker();t.find('[name="serviceId"]').change(s);l()}function c(){r.owner=e;r.initElements=h;r.pageUrl="../ServiceOrders/_OrderServiceItemUI";i=new app.BaseEditor(r,n);i.init();t=i.getContext()}function l(){t.find("form").submit(o)}function a(n){var t=n.validate({rules:{serviceId:{selectRequired:!0},vehicleId:{selectRequired:!0}}});i.setFormValidator(t)}var r={},i=null,e=this,t=null,f=app.services.OrderServiceItems.getInstance(),u=[];c()}window.app.OrderServiceItemEditor=n}(),function(){function n(n){function e(){r.owner=f;r.initElements=o;r.pageUrl="../Vehicles/_VehicleUI";i=new app.BaseEditor(r,n);i.init();t=i.getContext()}function o(){var i=t.find("form");n.data!==null&&typeof n.data=="object"&&l(i,n.data);s(i);c(i);app.maskUtils.maskAll(t);t.find(".selectpicker").selectpicker();app.ui.select.addressUI(t);h()}function s(n){var t=n.validate({rules:{model:{required:!0,minlength:3,maxlength:60},manufacturer:{minlength:3,maxlength:60},yearManufactureModel:{minlength:5,maxlength:5},type:{required:!0},plate:{required:!0,minlength:8,maxlength:8},chassi:{minlength:3,maxlength:17},renavam:{minlength:2,maxlength:11},color:{minlength:2,maxlength:20},countyId:{required:!0},cityId:{required:!0}}});i.setFormValidator(t)}function h(){t.find("form").submit(a);t.find('[name="yearManufactureModel"]').change(v)}function c(n){var i=n.find('[name="clientId"]'),r=parseInt(i.val()),u;isNaN(r)||r>0||(u=`
            <div class="row clearfix row-data">
	            <div class="col-sm-6">
		            <label>Cliente</label>
		            <div class="form-group">
			            <select name="clientId" data-live-search="true" class="form-control ui-selectpicker noupdate"></select>
		            </div>
	            </div>	
            </div>
            `,i.remove(),n.prepend(u),app.ui.select.clients({selectSelector:t.find('[name="clientId"]'),selected:undefined}))}function l(n,t){t.yearManufacture>0&&t.modelYear>0&&(t.yearManufactureModel=t.yearManufacture+"/"+t.modelYear);app.formUtils.loadData({formSelector:n,data:t,map:{countyId:[null,"countyName"],cityId:[null,"cityName"]}})}function a(n){n.preventDefault();i.submitForm(n.target,function(n){var t={newData:+n.id==0};return t.sendData=t.newData?u.createVehicle:u.updateVehicle,t})}function v(n){var i=n.target.value.split("/");t.find('[name="yearManufacture"]').val(i[0]||null);t.find('[name="modelYear"]').val(i[1]||null)}var r={},i=null,f=this,t=null,u=app.services.Vehicles.getInstance();e()}window.app.VehicleEditor=n}(),function(){function n(n){function e(){s();o()}function o(){var n=app.bootstrapTableUtils.mergeDefaultOptions({toolbar:"#appTabVehicles .btn-group-manager",url:app.services.Vehicles.getSearchUrl(),uniqueId:"id",columns:[{radio:"state",title:""},{field:"id",title:"Código",sortable:!0,formatter:function(n){return(n+"").padStart(6,"0")}},{field:"clientId",title:"Cód. Cliente",sortable:!0,formatter:function(n){return(n+"").padStart(6,"0")}},{field:"client.name",title:"Cliente",sortable:!0},{field:"plate",title:"Placa",sortable:!0},{field:"manufacturer",title:"Fabricante",sortable:!0},{field:"model",title:"Modelo",sortable:!0},{field:"color",title:"Cor",sortable:!0},{field:"type",title:"Tipo",sortable:!0,formatter:function(n){return app.entities.VehicleType[n]}},{field:"modalYear",title:"Ano",sortable:!0,formatter:function(n,t){return t.yearManufacture+"/"+t.modelYear}},{field:"cityName",title:"Cidade",sortable:!0},{field:"countyInitials",title:"UF",sortable:!0},{field:"chassis",title:"Chassi",sortable:!0},{field:"renavam",title:"Renavam",sortable:!0}]});t=$('[name="tableVehicles"]').bootstrapTable(n)}function s(){i.find('[name="newVehicle"]').click(h);i.find('[name="editVehicle"]').click(c);i.find('[name="deleteVehicle"]').click(l)}function u(n){var i={modal:!0,data:n,onSave:function(n,i){if(i){var r=app.bootstrapTableUtils.getDataById(t,n.id);r===null&&app.bootstrapTableUtils.insertData(t,n)}else app.bootstrapTableUtils.updateData(t,n,n.id);return app.notify.success("Veículo salvo com sucesso"),!0}};f=new app.VehicleEditor(i)}function h(){u({id:0})}function c(n){var i=app.bootstrapTableUtils.getSelected(t)[0];if(i===undefined){app.notify.warn("Selecione um veículo");return}$(n.target).attr("disabled","disabled");r.getById(i.id).then(function(t){$(n.target).attr("disabled",null);u(t)}).catch(function(t){$(n.target).attr("disabled",null);t.title===undefined?app.notify.error("Ops, falha inesperada. Contacte o suporte técnico. "+(t.message||"")):app.notify.error(t.title)})}function l(n){var i=app.bootstrapTableUtils.getSelected(t)[0];if(i===undefined){app.notify.warn("Selecione um veículo");return}$(n.target).attr("disabled","disabled");r.deleteClient(i.id).then(function(){$(n.target).attr("disabled",null);app.bootstrapTableUtils.removeData(t,i.id);app.notify.success("Veículo excluido")}).catch(function(t){$(n.target).attr("disabled",null);t.title===undefined?app.notify.error("Ops, falha inesperada. Contacte o suporte técnico. "+(t.message||"")):app.notify.error(t.title)})}var i=$(n.rootElement),t=null,f=null,r=app.services.Vehicles.getInstance();e()}window.app.VehiclesManager=n}(),function(){function n(n){function e(){i.owner=f;i.initElements=o;i.pageUrl="../Services/_ServiceUI";t=new app.BaseEditor(i,n);t.init();r=t.getContext()}function o(){var t=r.find("form");n.data!==null&&typeof n.data=="object"&&app.formUtils.loadData({formSelector:t,data:n.data});s(t);app.maskUtils.maskAll(r);h()}function s(n){var i=n.validate({rules:{name:{required:!0,minlength:3,maxlength:100},honorary:{required:!0,min:0,number:!0},rate:{required:!0,min:0,number:!0},plateCard:{required:!0,min:0,number:!0},other:{required:!0,min:0,number:!0}}});t.setFormValidator(i)}function h(){r.find("form").submit(c)}function c(n){n.preventDefault();t.submitForm(n.target,function(n){var t={newData:+n.id==0};return t.sendData=t.newData?u.createService:u.updateService,t})}var i={},t=null,f=this,r=null,u=app.services.Services.getInstance();e()}window.app.ServiceEditor=n}(),function(){function n(n){function e(){s();o()}function o(){var n=app.bootstrapTableUtils.mergeDefaultOptions({toolbar:"#appTabServices .btn-group-manager",url:app.services.Services.getSearchUrl(),uniqueId:"id",columns:[{radio:"state",title:""},{field:"id",title:"Código",sortable:!0,formatter:function(n){return(n+"").padStart(6,"0")}},{field:"name",title:"Nome",sortable:!0},{field:"honorary",title:"Honorário"},{field:"rate",title:"Taxa"},{field:"plateCard",title:"Placa/Targeta"},{field:"other",title:"Outros"}]});t=$('[name="tableServices"]').bootstrapTable(n)}function s(){i.find('[name="newService"]').click(h);i.find('[name="editService"]').click(c);i.find('[name="deleteService"]').click(l)}function u(n){var i={modal:!0,data:n,onSave:function(n,i){if(i){var r=app.bootstrapTableUtils.getDataById(t,n.id);r===null&&app.bootstrapTableUtils.insertData(t,n)}else app.bootstrapTableUtils.updateData(t,n,n.id);return app.notify.success("Serviço salvo com sucesso"),!0}};f=new app.ServiceEditor(i)}function h(){u({id:0})}function c(n){var i=app.bootstrapTableUtils.getSelected(t)[0];if(i===undefined){app.notify.warn("Selecione um serviço");return}$(n.target).attr("disabled","disabled");r.getById(i.id).then(function(t){$(n.target).attr("disabled",null);u(t)}).catch(function(t){$(n.target).attr("disabled",null);t.title===undefined?app.notify.error("Ops, falha inesperada. Contacte o suporte técnico. "+(t.message||"")):app.notify.error(t.title)})}function l(n){var i=app.bootstrapTableUtils.getSelected(t)[0];if(i===undefined){app.notify.warn("Selecione um serviço");return}$(n.target).attr("disabled","disabled");r.deleteService(i.id).then(function(){$(n.target).attr("disabled",null);app.bootstrapTableUtils.removeData(t,i.id);app.notify.success("Serviço excluido")}).catch(function(t){$(n.target).attr("disabled",null);t.title===undefined?app.notify.error("Ops, falha inesperada. Contacte o suporte técnico. "+(t.message||"")):app.notify.error(t.title)})}var i=$(n.rootElement),t=null,f=null,r=app.services.Services.getInstance();e()}window.app.ServicesManager=n}(),function(){function n(n){function o(){s();l().then(function(){app.ui.select.addressUI(t)})}function s(){var n=t.find("form");h(n);app.maskUtils.maskAll(t);c()}function h(n){i=n.validate({rules:{name:{required:!0,minlength:3,maxlength:100},email:{email:!0,minlength:3,maxlength:60},cpfCnpj:{minlength:14,maxlength:18},phone:{minlength:14,maxlength:15},"address.number":{minlength:1,maxlength:30},"address.street":{minlength:2,maxlength:200},"address.districtId":{},"address.cityId":{},"address.countyId":{}}})}function c(){t.find("form").submit(v);t.find('[name="setLogo"]').click(y);t.find('[name="fileLogo"]').change(p)}function l(){return r.getUserCompany().then(function(n){f=n;app.formUtils.loadData({formSelector:t.find("form"),data:n,map:{"address.countyId":[null,"address.countyName"],"address.cityId":[null,"address.cityName"],"address.districtId":[null,"address.districtName"]}});t.find(".masked").each(function(n,t){$(t).val($(t).masked())});e(n.id)}).catch(function(n){if(n.title===undefined){app.notify.error("Ops. Falha inesperada");return}n.status===400&&i!==null?(i.showErrors(n.errors),app.notify.warn(n.title)):app.notify.error(n.title)})}function e(n){var t=document.getElementById("config-companyLogo"),i=app.services.Companies.getBaseUri()+"/"+n+"/logo";fetch(i).then(function(n){return n.blob()}).then(function(n){var i=URL.createObjectURL(n);t.src=i})}function a(n,t){var i=new Image;i.src=window.URL.createObjectURL(n);i.onload=function(){var n=i.naturalWidth,r=i.naturalHeight;window.URL.revokeObjectURL(i.src);n>100||r>100?t.call(u,"A imagem deve ter a resolução máxima de 100x100"):t.call(u,"")}}function v(n){var u,f,e;n.preventDefault();u=n.target;try{if($(u).valid()===!1)return;f={formatterValue:function(n,i){var r=t.find('[name="'+i+'"].masked');return(r.length>0&&(n=r.cleanVal()),n==="")?undefined:n}};e=$(u).serializeJson(f);t.find('[type="submit"]').attr("disabled","disabled");r.updateCompany(e).then(function(){app.notify.success("Dados salvo com sucesso")}).catch(function(n){if(n.title===undefined){app.notify.error("Ops. Falha inesperada");return}n.status===400&&i!==null?(i.showErrors(n.errors),app.notify.warn(n.title)):app.notify.error(n.title)}).then(function(){t.find('[type="submit"]').attr("disabled",null)})}catch(o){t.find('[type="submit"]').attr("disabled",null);app.notify.error("Ops, falha inesperada. Contacte o suporte técnico.");console.log(o)}}function y(){t.find('[name="fileLogo"]').click()}function p(n){if(n.target.files.length!==0){var u=n.target.files[0];if(u.size>2097152){app.notify.warn("O arquivo excede o tamanho máximo de 2MB");return}a(u,function(n){if(n.length>0){app.notify.warn(n);return}t.find('[name="setLogo"]').attr("disabled","disabled");r.uploadLogo(u).then(function(){e(f.id);app.notify.success("Logo alterada com sucesso")}).catch(function(n){if(n.title===undefined){app.notify.error("Ops. Falha inesperada");return}n.status===400&&i!==null?(i.showErrors(n.errors),app.notify.warn(n.title)):app.notify.error(n.title)}).then(function(){t.find('[name="setLogo"]').attr("disabled",null)})})}}var u=this,t=$(n.rootElement),i=null,r=app.services.Companies.getInstance(),f=null;o()}window.app.CompanyConfigManager=n}();